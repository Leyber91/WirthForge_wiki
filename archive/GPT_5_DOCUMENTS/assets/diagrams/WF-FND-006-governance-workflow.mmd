graph LR
    subgraph "WIRTHFORGE Governance Workflow"
        A[Idea / Feature Proposal] --> B{Initial Review}
        B -->|Core Principles OK?| C{Technical Review}
        B -->|Violates Principles| G[Reject or Revise]
        
        C -->|Passes Tests| D[Sandbox Implementation]
        C -->|Concerns Found| G
        
        D --> E{Testing & Feedback}
        E -->|Successful in Sandbox| F[Approval & Integration]
        E -->|Issues in Sandbox| G
        
        F --> H[Release Planning & Version Bump]
        H --> I[Feature Release ðŸš€]
        G -->|Resubmit Proposal| B
    end
    
    subgraph "Governance Board Review"
        B --> B1[Technical Architect<br/>Performance & Security]
        B --> B2[Design Lead<br/>UX Consistency]
        B --> B3[Lore Keeper<br/>Thematic Alignment]
        B --> B4[Community Rep<br/>User Benefit]
        
        B1 --> ReviewDecision{Review Decision}
        B2 --> ReviewDecision
        B3 --> ReviewDecision
        B4 --> ReviewDecision
    end
    
    subgraph "Core Principles Check"
        PrincipleCheck[Core Invariants Validation]
        PrincipleCheck --> P1[âœ“ Local-Core Enforcement]
        PrincipleCheck --> P2[âœ“ No Docker/Native Execution]
        PrincipleCheck --> P3[âœ“ 60 FPS Real-Time Constraint]
        PrincipleCheck --> P4[âœ“ Energy-Truth Visualization]
        PrincipleCheck --> P5[âœ“ UI-Required Interface]
        PrincipleCheck --> P6[âœ“ Emergence, Not Preprogramming]
        
        P1 --> PrincipleResult{All Principles<br/>Satisfied?}
        P2 --> PrincipleResult
        P3 --> PrincipleResult
        P4 --> PrincipleResult
        P5 --> PrincipleResult
        P6 --> PrincipleResult
    end
    
    subgraph "Sandbox Testing Phase"
        D --> S1[Create Isolated Environment]
        S1 --> S2[Apply Sandbox Policy]
        S2 --> S3[Read-Only Data Access]
        S3 --> S4[Resource Limits Enforcement]
        S4 --> S5[Security Boundary Check]
        S5 --> S6[Performance Impact Test]
        S6 --> S7[User Experience Validation]
    end
    
    subgraph "Version Management"
        H --> V1{Change Type}
        V1 -->|Bug Fix| V2[Patch Version<br/>x.y.Z+1]
        V1 -->|New Feature| V3[Minor Version<br/>x.Y+1.0]
        V1 -->|Breaking Change| V4[Major Version<br/>X+1.0.0]
        
        V2 --> I
        V3 --> I
        V4 --> I
    end
    
    %% Connect principle check to main flow
    B -.-> PrincipleCheck
    PrincipleResult -->|Yes| C
    PrincipleResult -->|No| G
    
    %% Connect review to main flow
    ReviewDecision -->|Approved| C
    ReviewDecision -->|Approved with Changes| G
    ReviewDecision -->|Rejected| G
    ReviewDecision -->|Deferred| G
    
    %% Styling
    classDef proposal fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px
    classDef review fill:#e3f2fd,stroke:#1565c0,stroke-width:2px
    classDef principles fill:#f3e5f5,stroke:#6a1b9a,stroke-width:2px
    classDef sandbox fill:#fff8e1,stroke:#ef6c00,stroke-width:2px
    classDef decision fill:#ffebee,stroke:#c62828,stroke-width:2px
    classDef release fill:#f1f8e9,stroke:#558b2f,stroke-width:2px
    classDef version fill:#fce4ec,stroke:#ad1457,stroke-width:2px
    
    class A,B proposal
    class B1,B2,B3,B4,ReviewDecision review
    class PrincipleCheck,P1,P2,P3,P4,P5,P6,PrincipleResult principles
    class D,S1,S2,S3,S4,S5,S6,S7 sandbox
    class C,E,F,G decision
    class H,I release
    class V1,V2,V3,V4 version
