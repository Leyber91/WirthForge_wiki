{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "WIRTHFORGE Progression Policies",
  "description": "Defines progression rules, unlock criteria, and transition sequences",
  "type": "object",
  "properties": {
    "progression_rules": {
      "type": "object",
      "description": "Core rules governing user progression through experience levels",
      "properties": {
        "multi_criteria_requirement": {
          "type": "object",
          "properties": {
            "description": { "type": "string", "const": "Require N out of M criteria to be satisfied to prevent single-dimension gaming" },
            "minimum_criteria_ratio": { "type": "number", "const": 0.7 },
            "allow_time_override": { "type": "boolean", "const": true },
            "time_override_multiplier": { "type": "number", "const": 2.0 }
          },
          "required": ["description", "minimum_criteria_ratio", "allow_time_override", "time_override_multiplier"]
        },
        "safety_mechanisms": {
          "type": "object",
          "properties": {
            "minimum_time_gates": {
              "type": "object",
              "properties": {
                "enabled": { "type": "boolean", "const": true },
                "description": { "type": "string", "const": "Prevent users from rushing through levels too quickly" },
                "minimum_intervals_hours": {
                  "type": "object",
                  "properties": {
                    "level_2": { "type": "number", "const": 2.0 },
                    "level_3": { "type": "number", "const": 6.0 },
                    "level_4": { "type": "number", "const": 15.0 },
                    "level_5": { "type": "number", "const": 30.0 }
                  },
                  "required": ["level_2", "level_3", "level_4", "level_5"]
                }
              },
              "required": ["enabled", "description", "minimum_intervals_hours"]
            },
            "maximum_time_gates": {
              "type": "object",
              "properties": {
                "enabled": { "type": "boolean", "const": true },
                "description": { "type": "string", "const": "Automatically unlock levels if user has been stuck too long" },
                "maximum_intervals_hours": {
                  "type": "object",
                  "properties": {
                    "level_2": { "type": "number", "const": 24.0 },
                    "level_3": { "type": "number", "const": 72.0 },
                    "level_4": { "type": "number", "const": 168.0 },
                    "level_5": { "type": "number", "const": 336.0 }
                  },
                  "required": ["level_2", "level_3", "level_4", "level_5"]
                }
              },
              "required": ["enabled", "description", "maximum_intervals_hours"]
            },
            "no_regression": {
              "type": "object",
              "properties": {
                "enabled": { "type": "boolean", "const": true },
                "description": { "type": "string", "const": "Once a level is unlocked, it remains permanently available" },
                "allow_manual_downgrade": { "type": "boolean", "const": true },
                "downgrade_requires_confirmation": { "type": "boolean", "const": true }
              },
              "required": ["enabled", "description", "allow_manual_downgrade", "downgrade_requires_confirmation"]
            }
          },
          "required": ["minimum_time_gates", "maximum_time_gates", "no_regression"]
        }
      },
      "required": ["multi_criteria_requirement", "safety_mechanisms"]
    },
    "level_requirements": {
      "type": "object",
      "description": "Specific requirements for each level unlock",
      "properties": {
        "level_2": {
          "type": "object",
          "properties": {
            "name": { "type": "string", "const": "Council Formation" },
            "criteria": {
              "type": "object",
              "properties": {
                "time_based": {
                  "type": "object",
                  "properties": {
                    "session_time_hours": { "type": "number", "const": 3.0 },
                    "active_sessions": { "type": "integer", "const": 5 },
                    "weight": { "type": "number", "const": 0.3 }
                  },
                  "required": ["session_time_hours", "active_sessions", "weight"]
                },
                "usage_based": {
                  "type": "object",
                  "properties": {
                    "total_tokens_generated": { "type": "integer", "const": 5000 },
                    "successful_generations": { "type": "integer", "const": 10 },
                    "weight": { "type": "number", "const": 0.4 }
                  },
                  "required": ["total_tokens_generated", "successful_generations", "weight"]
                },
                "achievement_based": {
                  "type": "object",
                  "properties": {
                    "required_achievements": {
                      "type": "array",
                      "items": { "type": "string" },
                      "const": ["first_lightning", "generate_10_responses"]
                    },
                    "weight": { "type": "number", "const": 0.3 }
                  },
                  "required": ["required_achievements", "weight"]
                }
              },
              "required": ["time_based", "usage_based", "achievement_based"]
            }
          },
          "required": ["name", "criteria"]
        },
        "level_3": {
          "type": "object",
          "properties": {
            "name": { "type": "string", "const": "Architect Mind" },
            "criteria": {
              "type": "object",
              "properties": {
                "time_based": {
                  "type": "object",
                  "properties": {
                    "session_time_hours": { "type": "number", "const": 10.0 },
                    "council_sessions": { "type": "integer", "const": 15 },
                    "weight": { "type": "number", "const": 0.25 }
                  },
                  "required": ["session_time_hours", "council_sessions", "weight"]
                },
                "mastery_based": {
                  "type": "object",
                  "properties": {
                    "mastery_score": { "type": "number", "const": 0.8 },
                    "patterns_observed": { "type": "integer", "const": 20 },
                    "interference_witnessed": { "type": "integer", "const": 5 },
                    "weight": { "type": "number", "const": 0.4 }
                  },
                  "required": ["mastery_score", "patterns_observed", "interference_witnessed", "weight"]
                },
                "achievement_based": {
                  "type": "object",
                  "properties": {
                    "required_achievements": {
                      "type": "array",
                      "items": { "type": "string" },
                      "const": ["council_master", "harmony_achieved"]
                    },
                    "weight": { "type": "number", "const": 0.35 }
                  },
                  "required": ["required_achievements", "weight"]
                }
              },
              "required": ["time_based", "mastery_based", "achievement_based"]
            }
          },
          "required": ["name", "criteria"]
        },
        "level_4": {
          "type": "object",
          "properties": {
            "name": { "type": "string", "const": "Adaptive Flow" },
            "criteria": {
              "type": "object",
              "properties": {
                "time_based": {
                  "type": "object",
                  "properties": {
                    "session_time_hours": { "type": "number", "const": 25.0 },
                    "architecture_sessions": { "type": "integer", "const": 20 },
                    "weight": { "type": "number", "const": 0.2 }
                  },
                  "required": ["session_time_hours", "architecture_sessions", "weight"]
                },
                "creation_based": {
                  "type": "object",
                  "properties": {
                    "architectures_built": { "type": "integer", "const": 10 },
                    "patterns_saved": { "type": "integer", "const": 5 },
                    "dynamic_paths_created": { "type": "integer", "const": 3 },
                    "weight": { "type": "number", "const": 0.5 }
                  },
                  "required": ["architectures_built", "patterns_saved", "dynamic_paths_created", "weight"]
                },
                "mastery_based": {
                  "type": "object",
                  "properties": {
                    "mastery_score": { "type": "number", "const": 0.85 },
                    "complexity_handling": { "type": "number", "const": 0.8 },
                    "weight": { "type": "number", "const": 0.3 }
                  },
                  "required": ["mastery_score", "complexity_handling", "weight"]
                }
              },
              "required": ["time_based", "creation_based", "mastery_based"]
            }
          },
          "required": ["name", "criteria"]
        },
        "level_5": {
          "type": "object",
          "properties": {
            "name": { "type": "string", "const": "Consciousness Emergence" },
            "criteria": {
              "type": "object",
              "properties": {
                "time_based": {
                  "type": "object",
                  "properties": {
                    "session_time_hours": { "type": "number", "const": 50.0 },
                    "adaptive_sessions": { "type": "integer", "const": 30 },
                    "weight": { "type": "number", "const": 0.15 }
                  },
                  "required": ["session_time_hours", "adaptive_sessions", "weight"]
                },
                "mastery_based": {
                  "type": "object",
                  "properties": {
                    "mastery_score": { "type": "number", "const": 0.9 },
                    "adaptive_acceptance_rate": { "type": "number", "const": 0.7 },
                    "flow_control_demonstrated": { "type": "boolean", "const": true },
                    "weight": { "type": "number", "const": 0.4 }
                  },
                  "required": ["mastery_score", "adaptive_acceptance_rate", "flow_control_demonstrated", "weight"]
                },
                "emergence_based": {
                  "type": "object",
                  "properties": {
                    "resonances_detected": { "type": "integer", "const": 5 },
                    "consciousness_moments": { "type": "integer", "const": 2 },
                    "emergent_patterns_recognized": { "type": "integer", "const": 10 },
                    "weight": { "type": "number", "const": 0.45 }
                  },
                  "required": ["resonances_detected", "consciousness_moments", "emergent_patterns_recognized", "weight"]
                }
              },
              "required": ["time_based", "mastery_based", "emergence_based"]
            }
          },
          "required": ["name", "criteria"]
        }
      },
      "required": ["level_2", "level_3", "level_4", "level_5"]
    },
    "transition_sequences": {
      "type": "object",
      "description": "Orchestrated sequences for level transitions",
      "properties": {
        "standard_sequence": {
          "type": "object",
          "properties": {
            "steps": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "step": { "type": "string" },
                  "duration_ms": { "type": "integer" },
                  "event_type": { "type": "string" },
                  "description": { "type": "string" }
                },
                "required": ["step", "duration_ms", "event_type", "description"]
              },
              "const": [
                {
                  "step": "teaser",
                  "duration_ms": 2000,
                  "event_type": "experience.level_teaser",
                  "description": "Brief preview of upcoming level capabilities"
                },
                {
                  "step": "celebration",
                  "duration_ms": 3000,
                  "event_type": "reward.level_unlocked",
                  "description": "Achievement celebration with energy burst effects"
                },
                {
                  "step": "feature_introduction",
                  "duration_ms": 5000,
                  "event_type": "experience.feature_unlocked",
                  "description": "Sequential revelation of new UI elements and capabilities"
                },
                {
                  "step": "completion",
                  "duration_ms": 1000,
                  "event_type": "experience.transition_complete",
                  "description": "Transition completion and full feature activation"
                }
              ]
            },
            "total_duration_ms": { "type": "integer", "const": 11000 },
            "allow_skip": { "type": "boolean", "const": true },
            "skip_after_ms": { "type": "integer", "const": 3000 }
          },
          "required": ["steps", "total_duration_ms", "allow_skip", "skip_after_ms"]
        },
        "fast_track_sequence": {
          "type": "object",
          "properties": {
            "description": { "type": "string", "const": "Abbreviated sequence for users who meet criteria quickly" },
            "trigger_condition": { "type": "string", "const": "all_criteria_exceeded_by_50_percent" },
            "steps": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "step": { "type": "string" },
                  "duration_ms": { "type": "integer" },
                  "event_type": { "type": "string" },
                  "description": { "type": "string" }
                },
                "required": ["step", "duration_ms", "event_type", "description"]
              },
              "const": [
                {
                  "step": "recognition",
                  "duration_ms": 1500,
                  "event_type": "experience.mastery_recognized",
                  "description": "Acknowledge rapid mastery achievement"
                },
                {
                  "step": "unlock",
                  "duration_ms": 2000,
                  "event_type": "experience.level_up",
                  "description": "Direct level unlock with enhanced effects"
                },
                {
                  "step": "activation",
                  "duration_ms": 1500,
                  "event_type": "experience.features_activated",
                  "description": "Immediate activation of all new features"
                }
              ]
            },
            "total_duration_ms": { "type": "integer", "const": 5000 }
          },
          "required": ["description", "trigger_condition", "steps", "total_duration_ms"]
        }
      },
      "required": ["standard_sequence", "fast_track_sequence"]
    },
    "validation_rules": {
      "type": "object",
      "description": "Rules for validating progression decisions",
      "properties": {
        "criteria_validation": {
          "type": "object",
          "properties": {
            "require_multiple_sessions": { "type": "boolean", "const": true },
            "minimum_session_diversity": { "type": "number", "const": 0.6 },
            "anti_gaming_measures": {
              "type": "object",
              "properties": {
                "detect_rapid_clicking": { "type": "boolean", "const": true },
                "detect_automated_behavior": { "type": "boolean", "const": true },
                "require_meaningful_interaction": { "type": "boolean", "const": true }
              },
              "required": ["detect_rapid_clicking", "detect_automated_behavior", "require_meaningful_interaction"]
            }
          },
          "required": ["require_multiple_sessions", "minimum_session_diversity", "anti_gaming_measures"]
        },
        "rollback_conditions": {
          "type": "object",
          "properties": {
            "allow_rollback": { "type": "boolean", "const": false },
            "emergency_rollback_only": { "type": "boolean", "const": true },
            "rollback_triggers": {
              "type": "array",
              "items": { "type": "string" },
              "const": ["system_error", "data_corruption", "user_request_with_admin_approval"]
            }
          },
          "required": ["allow_rollback", "emergency_rollback_only", "rollback_triggers"]
        }
      },
      "required": ["criteria_validation", "rollback_conditions"]
    }
  },
  "required": ["progression_rules", "level_requirements", "transition_sequences", "validation_rules"]
}
