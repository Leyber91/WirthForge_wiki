graph TB
    %% WIRTHFORGE Energy Lifecycle Visualization
    %% Shows how user interactions create energy that flows through AI processing
    
    subgraph "User Input Layer"
        A[User Query] --> B[Energy Generation]
        B --> B1[Query Parsing]
        B --> B2[Intent Recognition]
        B --> B3[Context Gathering]
    end
    
    subgraph "Energy Processing Core"
        B1 --> C{Door Selection}
        B2 --> C
        B3 --> C
        
        C -->|ðŸ”¥ Forge Path| D1[Volcanic Energy<br/>Sharp Pulses]
        C -->|ðŸ’Ž Scholar Path| D2[Crystalline Energy<br/>Structured Flows]
        C -->|ðŸŒŸ Sage Path| D3[Ethereal Energy<br/>Consciousness Mist]
    end
    
    subgraph "AI Model Orchestra"
        D1 --> E[Model Selection]
        D2 --> E
        D3 --> E
        
        E --> F1[Primary Model<br/>Token Generation]
        E --> F2[Secondary Models<br/>Parallel Processing]
        E --> F3[Ensemble Coordination<br/>Result Synthesis]
        
        F1 --> G[Energy Transformation]
        F2 --> G
        F3 --> G
    end
    
    subgraph "Visualization Engine"
        G --> H[Real-time Rendering]
        H --> H1[Particle Systems<br/>â‰¤16.67ms Budget]
        H --> H2[Flow Dynamics<br/>60Hz Consistency]
        H --> H3[Energy Patterns<br/>Visual Feedback]
    end
    
    subgraph "User Experience Layer"
        H1 --> I[Visual Output]
        H2 --> I
        H3 --> I
        
        I --> J[Response Delivery]
        J --> K[Energy Persistence]
        K --> L[Learning Integration]
    end
    
    subgraph "Feedback Loop"
        L --> M[User Engagement]
        M --> N[Pattern Recognition]
        N --> O[Adaptive Optimization]
        O --> A
    end
    
    subgraph "Performance Monitoring"
        P[Energy Metrics] --> P1[Latency Tracking]
        P --> P2[Throughput Analysis]
        P --> P3[Quality Assessment]
        
        P1 --> Q[Performance Truth]
        P2 --> Q
        P3 --> Q
        Q --> H
    end
    
    %% Energy Flow Connections
    G -.-> P
    H -.-> P
    I -.-> P
    
    %% Progressive Level Integration
    subgraph "Gamification Integration"
        R[Current Level] --> R1[Level 1: Single Query]
        R --> R2[Level 2: Parallel Models]
        R --> R3[Level 3: Complex Chains]
        R --> R4[Level 4: Dynamic Switching]
        R --> R5[Level 5: Emergence Fields]
        
        R1 --> S[Energy Multiplier]
        R2 --> S
        R3 --> S
        R4 --> S
        R5 --> S
        S --> G
    end
    
    %% Styling
    classDef inputNode fill:#f59e0b,stroke:#d97706,stroke-width:2px,color:#000
    classDef processNode fill:#3b82f6,stroke:#2563eb,stroke-width:2px,color:#fff
    classDef aiNode fill:#a855f7,stroke:#9333ea,stroke-width:2px,color:#fff
    classDef visualNode fill:#10b981,stroke:#059669,stroke-width:2px,color:#fff
    classDef outputNode fill:#ef4444,stroke:#dc2626,stroke-width:2px,color:#fff
    classDef feedbackNode fill:#6b7280,stroke:#4b5563,stroke-width:2px,color:#fff
    classDef perfNode fill:#f97316,stroke:#ea580c,stroke-width:2px,color:#fff
    classDef gameNode fill:#8b5cf6,stroke:#7c3aed,stroke-width:2px,color:#fff
    
    class A,B,B1,B2,B3 inputNode
    class C,D1,D2,D3 processNode
    class E,F1,F2,F3,G aiNode
    class H,H1,H2,H3 visualNode
    class I,J,K,L outputNode
    class M,N,O feedbackNode
    class P,P1,P2,P3,Q perfNode
    class R,R1,R2,R3,R4,R5,S gameNode
