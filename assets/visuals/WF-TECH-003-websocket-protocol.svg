<svg viewBox="0 0 1400 900" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="connectionGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10B981;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#047857;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="dataFlowGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#3B82F6;stop-opacity:0.3" />
      <stop offset="50%" style="stop-color:#1D4ED8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1E40AF;stop-opacity:0.3" />
    </linearGradient>
    
    <radialGradient id="energyPulse" cx="50%" cy="50%" r="50%">
      <stop offset="0%" style="stop-color:#F59E0B;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#D97706;stop-opacity:0.3" />
    </radialGradient>
    
    <filter id="protocolGlow">
      <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
      <feMerge> 
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="1400" height="900" fill="#0F172A"/>
  
  <!-- Title -->
  <text x="700" y="40" text-anchor="middle" fill="#F8FAFC" font-family="Arial, sans-serif" font-size="28" font-weight="bold">
    🔌 WIRTHFORGE WebSocket Protocol System
  </text>
  <text x="700" y="65" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="14">
    Real-Time Energy Streaming • 60Hz Performance • Local WebSocket Server
  </text>
  
  <!-- Protocol Lifecycle -->
  <g id="protocol-timeline">
    <rect x="50" y="90" width="1300" height="80" rx="10" fill="#1E293B" stroke="#10B981" stroke-width="2"/>
    <text x="700" y="115" text-anchor="middle" fill="#10B981" font-family="Arial, sans-serif" font-size="16" font-weight="bold">
      🔄 WebSocket Protocol Lifecycle
    </text>
    
    <rect x="80" y="130" width="150" height="25" rx="5" fill="url(#connectionGradient)"/>
    <text x="155" y="147" text-anchor="middle" fill="#FFF" font-family="Arial, sans-serif" font-size="10">🤝 Connection</text>
    
    <rect x="250" y="130" width="150" height="25" rx="5" fill="#3B82F6"/>
    <text x="325" y="147" text-anchor="middle" fill="#FFF" font-family="Arial, sans-serif" font-size="10">🔐 Handshake</text>
    
    <rect x="420" y="130" width="150" height="25" rx="5" fill="#F59E0B"/>
    <text x="495" y="147" text-anchor="middle" fill="#FFF" font-family="Arial, sans-serif" font-size="10">⚡ 60Hz Loop</text>
    
    <rect x="590" y="130" width="150" height="25" rx="5" fill="#EC4899"/>
    <text x="665" y="147" text-anchor="middle" fill="#FFF" font-family="Arial, sans-serif" font-size="10">💓 Heartbeat</text>
    
    <rect x="760" y="130" width="150" height="25" rx="5" fill="#EF4444"/>
    <text x="835" y="147" text-anchor="middle" fill="#FFF" font-family="Arial, sans-serif" font-size="10">🚨 Error Recovery</text>
    
    <rect x="930" y="130" width="150" height="25" rx="5" fill="#8B5CF6"/>
    <text x="1005" y="147" text-anchor="middle" fill="#FFF" font-family="Arial, sans-serif" font-size="10">👋 Shutdown</text>
  </g>
  
  <!-- Browser Client -->
  <g id="browser-client">
    <rect x="50" y="200" width="350" height="250" rx="15" fill="#1E293B" stroke="#3B82F6" stroke-width="2"/>
    <text x="225" y="225" text-anchor="middle" fill="#3B82F6" font-family="Arial, sans-serif" font-size="16" font-weight="bold">
      🌐 Browser Client
    </text>
    
    <rect x="70" y="245" width="310" height="50" rx="8" fill="#374151" stroke="#60A5FA" stroke-width="1"/>
    <text x="225" y="265" text-anchor="middle" fill="#60A5FA" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      🔌 WebSocket Connection Manager
    </text>
    <text x="225" y="280" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="10">
      ws://127.0.0.1:8000/ws • Auto-reconnect
    </text>
    
    <rect x="70" y="305" width="310" height="50" rx="8" fill="#374151" stroke="#10B981" stroke-width="1"/>
    <text x="225" y="325" text-anchor="middle" fill="#10B981" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      ⚡ Real-Time Energy Visualizer
    </text>
    <text x="225" y="340" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="10">
      60Hz Canvas • Energy Truth Display
    </text>
    
    <rect x="70" y="365" width="310" height="50" rx="8" fill="#374151" stroke="#F59E0B" stroke-width="1"/>
    <text x="225" y="385" text-anchor="middle" fill="#F59E0B" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      💓 Health Monitor
    </text>
    <text x="225" y="400" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="10">
      Connection status • Latency tracking
    </text>
    
    <circle cx="360" cy="250" r="12" fill="#10B981" filter="url(#protocolGlow)">
      <animate attributeName="opacity" values="1;0.5;1" dur="2s" repeatCount="indefinite"/>
    </circle>
    <text x="360" y="255" text-anchor="middle" fill="#FFF" font-family="Arial, sans-serif" font-size="8">✓</text>
  </g>
  
  <!-- WebSocket Server -->
  <g id="websocket-server">
    <rect x="450" y="200" width="350" height="250" rx="15" fill="#1E293B" stroke="#10B981" stroke-width="2"/>
    <text x="625" y="225" text-anchor="middle" fill="#10B981" font-family="Arial, sans-serif" font-size="16" font-weight="bold">
      🚀 WebSocket Server
    </text>
    
    <rect x="470" y="245" width="310" height="50" rx="8" fill="#374151" stroke="#10B981" stroke-width="1"/>
    <text x="625" y="265" text-anchor="middle" fill="#10B981" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      🔌 FastAPI Handler
    </text>
    <text x="625" y="280" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="10">
      localhost:8000 • Message routing
    </text>
    
    <rect x="470" y="305" width="310" height="50" rx="8" fill="#374151" stroke="#F59E0B" stroke-width="1"/>
    <text x="625" y="325" text-anchor="middle" fill="#F59E0B" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      ⚡ Energy Event Broadcaster
    </text>
    <text x="625" y="340" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="10">
      60Hz Stream • Multi-client support
    </text>
    
    <rect x="470" y="365" width="310" height="50" rx="8" fill="#374151" stroke="#EC4899" stroke-width="1"/>
    <text x="625" y="385" text-anchor="middle" fill="#EC4899" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      🩺 Health Service
    </text>
    <text x="625" y="400" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="10">
      Performance metrics • Error tracking
    </text>
    
    <circle cx="760" cy="250" r="12" fill="#F59E0B" filter="url(#protocolGlow)">
      <animate attributeName="r" values="10;15;10" dur="1.5s" repeatCount="indefinite"/>
    </circle>
    <text x="760" y="255" text-anchor="middle" fill="#FFF" font-family="Arial, sans-serif" font-size="8">⚡</text>
  </g>
  
  <!-- DECIPHER Engine -->
  <g id="decipher-engine">
    <rect x="850" y="200" width="350" height="250" rx="15" fill="#1E293B" stroke="#F59E0B" stroke-width="2"/>
    <text x="1025" y="225" text-anchor="middle" fill="#F59E0B" font-family="Arial, sans-serif" font-size="16" font-weight="bold">
      ⚡ DECIPHER Engine
    </text>
    
    <rect x="870" y="245" width="310" height="50" rx="8" fill="#374151" stroke="#F59E0B" stroke-width="1"/>
    <text x="1025" y="265" text-anchor="middle" fill="#F59E0B" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      🧮 Energy Computation
    </text>
    <text x="1025" y="280" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="10">
      E(t) calculation • Diversity index
    </text>
    
    <rect x="870" y="305" width="310" height="50" rx="8" fill="#374151" stroke="#8B5CF6" stroke-width="1"/>
    <text x="1025" y="325" text-anchor="middle" fill="#8B5CF6" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      🌊 Resonance Detection
    </text>
    <text x="1025" y="340" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="10">
      Pattern analysis • Harmonic sync
    </text>
    
    <rect x="870" y="365" width="310" height="50" rx="8" fill="#374151" stroke="#EC4899" stroke-width="1"/>
    <text x="1025" y="385" text-anchor="middle" fill="#EC4899" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      📊 Event Generator
    </text>
    <text x="1025" y="400" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="10">
      60Hz events • WebSocket integration
    </text>
    
    <circle cx="1160" cy="250" r="15" fill="url(#energyPulse)" filter="url(#protocolGlow)">
      <animate attributeName="r" values="12;18;12" dur="1s" repeatCount="indefinite"/>
    </circle>
    <text x="1160" y="255" text-anchor="middle" fill="#FFF" font-family="Arial, sans-serif" font-size="10">E</text>
  </g>
  
  <!-- Data Flow -->
  <g id="data-flow">
    <path d="M 400 325 Q 425 325 450 325" stroke="#3B82F6" stroke-width="4" fill="none">
      <animate attributeName="stroke-dasharray" values="0,20;10,10;20,0" dur="1s" repeatCount="indefinite"/>
    </path>
    <text x="425" y="315" text-anchor="middle" fill="#3B82F6" font-family="Arial, sans-serif" font-size="10">Messages</text>
    
    <path d="M 450 375 Q 425 375 400 375" stroke="#10B981" stroke-width="4" fill="none">
      <animate attributeName="stroke-dasharray" values="0,20;10,10;20,0" dur="1.2s" repeatCount="indefinite"/>
    </path>
    <text x="425" y="390" text-anchor="middle" fill="#10B981" font-family="Arial, sans-serif" font-size="10">Events</text>
    
    <path d="M 800 325 Q 825 325 850 325" stroke="#F59E0B" stroke-width="4" fill="none">
      <animate attributeName="stroke-dasharray" values="0,20;10,10;20,0" dur="0.8s" repeatCount="indefinite"/>
    </path>
    <text x="825" y="315" text-anchor="middle" fill="#F59E0B" font-family="Arial, sans-serif" font-size="10">Tokens</text>
    
    <path d="M 850 375 Q 825 375 800 375" stroke="#EC4899" stroke-width="4" fill="none">
      <animate attributeName="stroke-dasharray" values="0,20;10,10;20,0" dur="1.5s" repeatCount="indefinite"/>
    </path>
    <text x="825" y="390" text-anchor="middle" fill="#EC4899" font-family="Arial, sans-serif" font-size="10">Energy</text>
  </g>
  
  <!-- Message Types -->
  <g id="message-types">
    <rect x="50" y="480" width="1300" height="180" rx="10" fill="#1E293B" stroke="#8B5CF6" stroke-width="2"/>
    <text x="700" y="510" text-anchor="middle" fill="#8B5CF6" font-family="Arial, sans-serif" font-size="18" font-weight="bold">
      📋 WebSocket Message Types
    </text>
    
    <rect x="80" y="530" width="180" height="100" rx="8" fill="#374151" stroke="#10B981" stroke-width="1"/>
    <text x="170" y="550" text-anchor="middle" fill="#10B981" font-family="Arial, sans-serif" font-size="12" font-weight="bold">🤝 Connection</text>
    <text x="170" y="570" text-anchor="middle" fill="#D1FAE5" font-family="monospace" font-size="9">{"type": "connect"}</text>
    <text x="170" y="585" text-anchor="middle" fill="#D1FAE5" font-family="monospace" font-size="9">{"type": "ready"}</text>
    <text x="170" y="600" text-anchor="middle" fill="#D1FAE5" font-family="monospace" font-size="9">{"type": "disconnect"}</text>
    <text x="170" y="620" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="8">Lifecycle events</text>
    
    <rect x="280" y="530" width="180" height="100" rx="8" fill="#374151" stroke="#F59E0B" stroke-width="1"/>
    <text x="370" y="550" text-anchor="middle" fill="#F59E0B" font-family="Arial, sans-serif" font-size="12" font-weight="bold">⚡ Energy</text>
    <text x="370" y="570" text-anchor="middle" fill="#FDE68A" font-family="monospace" font-size="9">{"type": "energy_update"}</text>
    <text x="370" y="585" text-anchor="middle" fill="#FDE68A" font-family="monospace" font-size="9">{"type": "energy_peak"}</text>
    <text x="370" y="600" text-anchor="middle" fill="#FDE68A" font-family="monospace" font-size="9">{"type": "diversity_index"}</text>
    <text x="370" y="620" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="8">Real-time data</text>
    
    <rect x="480" y="530" width="180" height="100" rx="8" fill="#374151" stroke="#3B82F6" stroke-width="1"/>
    <text x="570" y="550" text-anchor="middle" fill="#3B82F6" font-family="Arial, sans-serif" font-size="12" font-weight="bold">🎯 Tokens</text>
    <text x="570" y="570" text-anchor="middle" fill="#DBEAFE" font-family="monospace" font-size="9">{"type": "token_stream"}</text>
    <text x="570" y="585" text-anchor="middle" fill="#DBEAFE" font-family="monospace" font-size="9">{"type": "session_start"}</text>
    <text x="570" y="600" text-anchor="middle" fill="#DBEAFE" font-family="monospace" font-size="9">{"type": "session_end"}</text>
    <text x="570" y="620" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="8">Generation flow</text>
    
    <rect x="680" y="530" width="180" height="100" rx="8" fill="#374151" stroke="#EC4899" stroke-width="1"/>
    <text x="770" y="550" text-anchor="middle" fill="#EC4899" font-family="Arial, sans-serif" font-size="12" font-weight="bold">💓 Health</text>
    <text x="770" y="570" text-anchor="middle" fill="#FBCFE8" font-family="monospace" font-size="9">{"type": "heartbeat"}</text>
    <text x="770" y="585" text-anchor="middle" fill="#FBCFE8" font-family="monospace" font-size="9">{"type": "health_check"}</text>
    <text x="770" y="600" text-anchor="middle" fill="#FBCFE8" font-family="monospace" font-size="9">{"type": "performance"}</text>
    <text x="770" y="620" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="8">Monitoring</text>
    
    <rect x="880" y="530" width="180" height="100" rx="8" fill="#374151" stroke="#EF4444" stroke-width="1"/>
    <text x="970" y="550" text-anchor="middle" fill="#EF4444" font-family="Arial, sans-serif" font-size="12" font-weight="bold">🚨 Errors</text>
    <text x="970" y="570" text-anchor="middle" fill="#FECACA" font-family="monospace" font-size="9">{"type": "error"}</text>
    <text x="970" y="585" text-anchor="middle" fill="#FECACA" font-family="monospace" font-size="9">{"type": "timeout"}</text>
    <text x="970" y="600" text-anchor="middle" fill="#FECACA" font-family="monospace" font-size="9">{"type": "recovery"}</text>
    <text x="970" y="620" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="8">Error handling</text>
    
    <rect x="1080" y="530" width="180" height="100" rx="8" fill="#374151" stroke="#8B5CF6" stroke-width="1"/>
    <text x="1170" y="550" text-anchor="middle" fill="#8B5CF6" font-family="Arial, sans-serif" font-size="12" font-weight="bold">🏆 Achievements</text>
    <text x="1170" y="570" text-anchor="middle" fill="#E9D5FF" font-family="monospace" font-size="9">{"type": "resonance"}</text>
    <text x="1170" y="585" text-anchor="middle" fill="#E9D5FF" font-family="monospace" font-size="9">{"type": "level_unlock"}</text>
    <text x="1170" y="600" text-anchor="middle" fill="#E9D5FF" font-family="monospace" font-size="9">{"type": "celebration"}</text>
    <text x="1170" y="620" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="8">Progressive unlocks</text>
  </g>
  
  <!-- Performance Metrics -->
  <g id="performance-metrics">
    <rect x="50" y="690" width="1300" height="150" rx="10" fill="#1E293B" stroke="#374151" stroke-width="2"/>
    <text x="700" y="720" text-anchor="middle" fill="#F8FAFC" font-family="Arial, sans-serif" font-size="18" font-weight="bold">
      📊 Real-Time Protocol Performance
    </text>
    
    <rect x="100" y="740" width="150" height="80" rx="8" fill="#374151" stroke="#10B981" stroke-width="2"/>
    <text x="175" y="765" text-anchor="middle" fill="#10B981" font-family="Arial, sans-serif" font-size="14" font-weight="bold">2.4ms</text>
    <text x="175" y="780" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="10">Latency</text>
    <text x="175" y="795" text-anchor="middle" fill="#10B981" font-family="Arial, sans-serif" font-size="8">✓ Under 5ms</text>
    <rect x="110" y="805" width="130" height="6" rx="3" fill="#374151"/>
    <rect x="110" y="805" width="50" height="6" rx="3" fill="#10B981"/>
    
    <rect x="270" y="740" width="150" height="80" rx="8" fill="#374151" stroke="#3B82F6" stroke-width="2"/>
    <text x="345" y="765" text-anchor="middle" fill="#3B82F6" font-family="Arial, sans-serif" font-size="14" font-weight="bold">60.0</text>
    <text x="345" y="780" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="10">Messages/sec</text>
    <text x="345" y="795" text-anchor="middle" fill="#3B82F6" font-family="Arial, sans-serif" font-size="8">Perfect 60Hz</text>
    <circle cx="345" cy="805" r="4" fill="#3B82F6">
      <animate attributeName="opacity" values="1;0.3;1" dur="1s" repeatCount="indefinite"/>
    </circle>
    
    <rect x="440" y="740" width="150" height="80" rx="8" fill="#374151" stroke="#8B5CF6" stroke-width="2"/>
    <text x="515" y="765" text-anchor="middle" fill="#8B5CF6" font-family="Arial, sans-serif" font-size="14" font-weight="bold">3</text>
    <text x="515" y="780" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="10">Connections</text>
    <text x="515" y="795" text-anchor="middle" fill="#8B5CF6" font-family="Arial, sans-serif" font-size="8">Multi-client</text>
    <rect x="460" y="805" width="110" height="6" rx="3" fill="#374151"/>
    <rect x="460" y="805" width="33" height="6" rx="3" fill="#8B5CF6"/>
    
    <rect x="610" y="740" width="150" height="80" rx="8" fill="#374151" stroke="#EC4899" stroke-width="2"/>
    <circle cx="685" cy="760" r="12" fill="#EC4899" filter="url(#protocolGlow)">
      <animate attributeName="r" values="10;15;10" dur="2s" repeatCount="indefinite"/>
    </circle>
    <text x="685" y="765" text-anchor="middle" fill="#FFF" font-family="Arial, sans-serif" font-size="8">💓</text>
    <text x="685" y="780" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="10">Heartbeat</text>
    <text x="685" y="795" text-anchor="middle" fill="#EC4899" font-family="Arial, sans-serif" font-size="8">Healthy</text>
    
    <rect x="780" y="740" width="150" height="80" rx="8" fill="#374151" stroke="#F59E0B" stroke-width="2"/>
    <text x="855" y="765" text-anchor="middle" fill="#F59E0B" font-family="Arial, sans-serif" font-size="14" font-weight="bold">847.3J</text>
    <text x="855" y="780" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="10">Energy Rate</text>
    <text x="855" y="795" text-anchor="middle" fill="#F59E0B" font-family="Arial, sans-serif" font-size="8">Real-time</text>
    <circle cx="855" cy="805" r="4" fill="#F59E0B">
      <animate attributeName="opacity" values="1;0.5;1" dur="1.5s" repeatCount="indefinite"/>
    </circle>
    
    <rect x="950" y="740" width="150" height="80" rx="8" fill="#374151" stroke="#10B981" stroke-width="2"/>
    <text x="1025" y="765" text-anchor="middle" fill="#10B981" font-family="Arial, sans-serif" font-size="14" font-weight="bold">LOCAL</text>
    <text x="1025" y="780" text-anchor="middle" fill="#94A3B8" font-family="Arial, sans-serif" font-size="10">Network</text>
    <text x="1025" y="795" text-anchor="middle" fill="#10B981" font-family="Arial, sans-serif" font-size="8">127.0.0.1</text>
    <rect x="970" y="805" width="110" height="6" rx="3" fill="#10B981"/>
  </g>
  
  <!-- System Status -->
  <g id="system-status">
    <rect x="50" y="860" width="1300" height="30" rx="5" fill="#065F46" stroke="#10B981" stroke-width="2"/>
    <circle cx="80" cy="875" r="10" fill="#10B981" filter="url(#protocolGlow)">
      <animate attributeName="r" values="8;12;8" dur="2s" repeatCount="indefinite"/>
    </circle>
    <text x="80" y="879" text-anchor="middle" fill="#FFF" font-family="Arial, sans-serif" font-size="8">✓</text>
    
    <text x="110" y="870" fill="#10B981" font-family="Arial, sans-serif" font-size="14" font-weight="bold">
      WEBSOCKET PROTOCOL ACTIVE
    </text>
    <text x="110" y="885" fill="#D1FAE5" font-family="Arial, sans-serif" font-size="12">
      Real-time streaming at 60Hz • 3 active connections • 2.4ms latency • Energy truth enabled
    </text>
    
    <text x="1300" y="879" text-anchor="end" fill="#D1FAE5" font-family="Arial, sans-serif" font-size="10">
      Last heartbeat: 16.67ms ago
    </text>
  </g>
</svg>
